# Compliance Development Practices

> **Usage**: Include when working on any compliance-related features or when handling regulated data
> 
> **Constitutional Status**: These practices contain IMMUTABLE principles (marked ðŸ”’) that require formal amendment process to change, and FLEXIBLE guidelines that can evolve with project needs.

**Version**: 2.0.0 | **Ratified**: [Current Date] | **Last Amended**: [Current Date]

## Scope and Definitions

### Auditing vs. Logging

This document distinguishes between two critical but separate concerns:

- **AUDITING**: Ensures the integrity of database contents through immutable, tamper-evident records of all data modifications. Purpose: regulatory compliance, data integrity verification, forensic investigation. Audit trails are permanent records for compliance officers and regulators.

- **LOGGING**: Captures system events for debugging and performance evaluation. Purpose: troubleshooting, monitoring, performance optimization. Logs are operational tools for developers and may be rotated/archived based on retention policies.

**Critical Distinction**: Audit trails are compliance artifacts subject to regulatory requirements. Logs are operational artifacts subject to technical requirements. Never conflate the two.

## ðŸ”’ Constitutional Principles for AI-Assisted Development

> **IMMUTABLE**: These principles are non-negotiable and apply to all code, whether written by humans or generated by AI agents.

### AI Development Governance

When using AI-assisted development tools (Claude, GitHub Copilot, etc.), the following principles MUST be enforced:

1. **ðŸ”’ AI-Generated Code Validation (NON-NEGOTIABLE)**
   - All AI-generated code MUST undergo the same validation as human-written code
   - AI cannot bypass TDD requirements, compliance checks, or code review
   - AI-generated implementations MUST include full audit trail support
   - AI MUST follow ALCOA+ principles in all data handling code

2. **Constitutional Constraints for AI Agents**
   - AI must interpret requirements through the lens of these compliance practices
   - When generating code, AI must:
     - Include audit trail capture for all data modifications
     - Implement proper authentication/authorization checks
     - Follow encryption standards for sensitive data
     - Generate tests BEFORE implementation code
     - Apply library-first for major features (see Principle I for scope)
     - **Ask user when unclear**: "Should this be a library or direct implementation?"

3. **Library-First Decision Making for AI**
   - If ticket specifies "library" or "major feature" â†’ Use library-first
   - If ticket says "tweak", "fix", "adjust UI", "config" â†’ Direct implementation OK
   - If unclear from context:
     - AI MUST ask: "This appears to be [major feature/minor tweak]. Should I implement as a standalone library or direct application code?"
     - Provide recommendation based on: complexity, reusability potential, scope
     - Wait for user confirmation before proceeding

4. **AI Output Verification**
   - Human developer MUST verify that AI-generated code:
     - Captures required audit metadata
     - Implements proper error handling for compliance scenarios
     - Includes validation for regulatory requirements
     - Has no hardcoded credentials or sensitive data exposure
     - Correctly applied library-first vs. direct implementation decision
   
5. **Specification-Driven AI Development**
   - AI agents MUST work from complete specifications that define:
     - Compliance requirements explicitly
     - Expected audit trail behavior
     - Security constraints
     - Data integrity requirements
     - Whether feature is library-worthy (major) or direct implementation (minor)
   - Specifications serve as validation gates for AI output
   - Implementation plans generated by AI must pass constitutional checks

**Rationale**: AI accelerates development but cannot compromise compliance. These principles ensure AI serves our compliance standards rather than circumventing them. AI asking for clarification on library-first scope prevents both over-engineering (libraries for tweaks) and under-engineering (direct implementation for major features).

## Regulatory Framework Understanding

### Know Your Requirements

Before implementing compliance features, understand:

- **Which regulations apply**: FDA 21 CFR Part 11, GDPR, HIPAA, ISO 27001, SOC-2.
- **Specific requirements**: Read the actual regulation text, not just summaries
- **Interpretation**: Understand how your organization interprets requirements
- **Validation needs**: What evidence must be produced for audits

### Key Compliance Areas

1. **Data Integrity** (ALCOA+ Principles)
   - **A**ttributable: Who created or modified the data?
   - **L**egible: Is data readable and understandable?
   - **C**ontemporaneous: Recorded at the time of activity?
   - **O**riginal: First capture or certified true copy?
   - **A**ccurate: Free from errors, correct?
   - **+Complete**: All data captured?
   - **+Consistent**: Sequence of events logical?
   - **+Enduring**: Retained for required period?
   - **+Available**: Retrievable for review/audit?

2. **Electronic Signatures** (21 CFR Part 11.50)
   - Unique to one individual
   - Not reused or reassigned
   - Verified before use
   - Cryptographically secure

3. **Audit Trail** (21 CFR Part 11.10(e))
   - Secure, computer-generated, time-stamped
   - Records: date, time, who performed action, what changed
   - Independent of main record
   - Cannot be altered
   - Regularly reviewed
   - **Purpose**: Data integrity verification and regulatory compliance
   - **Not for**: Debugging, performance monitoring, or operational logging

## Implementation Requirements

### Audit Trail Implementation (Data Integrity)

> **Purpose**: Ensure database integrity through immutable records of data changes. This is NOT operational logging.

**Every data modification must be audited with**:

```
{
  "event_id": "unique identifier",
  "timestamp": "ISO 8601 UTC timestamp",
  "user_id": "authenticated user identifier",
  "user_name": "display name at time of action",
  "action": "CREATE | UPDATE | DELETE | SIGN",
  "entity_type": "what was modified",
  "entity_id": "specific record identifier",
  "before_value": "previous state (for updates)",
  "after_value": "new state",
  "reason": "reason for change (if required)",
  "session_id": "session identifier",
  "device_info": "device/platform information",
  "ip_address": "source IP (if applicable)",
  "hash": "cryptographic hash for tamper detection"
}
```

**Required Characteristics**:

âœ… Append-only (no updates or deletes to audit log)
âœ… Immutable (tamper-evident with cryptographic hashing)
âœ… Synchronized (captured at time of action, not batched)
âœ… Complete (captures all required metadata)
âœ… Retrievable (queryable for audits and investigations)
âœ… Retained (stored for required retention period)

**Implementation Pattern**:

```dart
// Example: Audit trail wrapper for all data operations
// NOTE: This is AUDITING (data integrity), not LOGGING (debugging)
Future<T> auditedDataOperation<T>({
  required String action,
  required String entityType,
  required String entityId,
  required Future<T> Function() operation,
  Map<String, dynamic>? beforeValue,
  Map<String, dynamic>? afterValue,
  String? reason,
}) async {
  final auditEntry = AuditEntry(
    eventId: Uuid().v4(),
    timestamp: DateTime.now().toUtc(),
    userId: currentUser.id,
    userName: currentUser.displayName,
    action: action,
    entityType: entityType,
    entityId: entityId,
    beforeValue: beforeValue,
    afterValue: afterValue,
    reason: reason,
    sessionId: currentSession.id,
    deviceInfo: DeviceInfo.current,
  );
  
  try {
    final result = await operation();
    auditEntry.status = 'SUCCESS';
    await auditTrail.append(auditEntry);  // Audit trail, not log
    return result;
  } catch (e) {
    auditEntry.status = 'FAILED';
    auditEntry.errorDetails = e.toString();
    await auditTrail.append(auditEntry);  // Audit trail, not log
    rethrow;
  }
}
```

### Authentication & Authorization

**Authentication Requirements**:

- Multi-factor authentication for high-risk operations
- Password complexity requirements
- Account lockout after failed attempts
- Session timeout enforcement
- Secure password storage (never plaintext)
- Password reset with verification

**Authorization Requirements**:

- Role-based access control (RBAC)
- Principle of least privilege
- Verify permissions at every access point
- Document permission matrix
- Regular access reviews

**Implementation Checklist**:

- [ ] User authentication verified before any operation
- [ ] Session tokens cryptographically secure
- [ ] Sessions expire after inactivity
- [ ] Roles and permissions clearly defined
- [ ] Authorization checked on backend (never trust client)
- [ ] Permission changes are audited
- [ ] User account actions are audited (login, logout, password change)

### Data Encryption

**Encryption at Rest**:

- All sensitive data encrypted in database
- Use industry-standard algorithms (AES-256)
- Proper key management (never hardcode keys)
- Key rotation policy
- Secure key storage (hardware keystores when possible)

**Encryption in Transit**:

- TLS 1.2 or higher for all network communication
- Certificate pinning for sensitive apps
- No mixed content (all resources over HTTPS)
- Secure WebSocket connections (WSS)

**Implementation Checklist**:

- [ ] Database encrypted (e.g., SQLCipher)
- [ ] Encryption keys stored in secure keystore
- [ ] Sensitive fields additionally encrypted
- [ ] All API calls use HTTPS
- [ ] Certificate validation enabled
- [ ] No sensitive data in URLs or logs

### Validation and Testing

**Compliance Testing Requirements**:

1. **Functional Testing**
   - Verify all compliance features work as designed
   - Test audit trail captures all required events
   - Test authentication and authorization enforcement
   - Test data encryption and decryption

2. **Security Testing**
   - Penetration testing
   - Vulnerability scanning
   - Access control verification
   - Encryption validation

3. **Audit Trail Testing**
   - Verify completeness (all events captured)
   - Verify accuracy (correct metadata)
   - Verify tamper-evidence (hash validation)
   - Verify retention (data persists as required)

4. **Traceability Testing**
   - Requirements traceability matrix
   - Map each requirement to test case
   - Map each test case to implementation
   - Document test results

**Test Data Management**:

- Never use real PHI/PII in test environments
- Generate realistic synthetic data
- Sanitize production data before using for testing
- Follow data privacy regulations even for test data


**Documentation Standards**:

- Version control all documentation
- Maintain change history
- Regular review and updates
- Accessible for audits

### Change Control

**All changes to validated systems require**:

1. **Change Request**
   - Description of change
   - Justification (why needed)
   - Impact assessment (what's affected)
   - Risk assessment

2. **Approval**
   - Technical review
   - Quality assurance review
 
3. **Implementation**
   - Follow development standards
   - Update all affected documentation
   - Perform regression testing
   - Update validation if needed

4. **Verification**
   - Test changes work as intended
   - Verify no adverse impacts
   - Review audit trail

5. **Documentation**
   - Update user documentation
   - Update technical documentation
   - Record in change log
   - Close change request

**Emergency Changes**:

- Documented procedure for urgent fixes
- Retrospective approval process
- Complete documentation required
- Must not bypass critical controls

## Compliance Don'ts

âŒ **Never** disable audit trail capture for any reason
âŒ **Never** modify historical audit records
âŒ **Never** share authentication credentials
âŒ **Never** store passwords in plain text
âŒ **Never** skip validation testing "to save time"
âŒ **Never** use production data in test environments
âŒ **Never** make undocumented changes to validated systems
âŒ **Never** assume compliance - verify and document
âŒ **Never** implement compliance features without understanding requirements
âŒ **Never** delete data that may be subject to retention requirements
âŒ **Never** conflate audit trails (compliance) with operational logs (debugging)

## Data Privacy (GDPR, HIPAA, etc.)

### Core Principles

1. **Data Minimization**: Collect only necessary data
2. **Purpose Limitation**: Use data only for stated purposes
3. **Storage Limitation**: Retain only as long as necessary
4. **Accuracy**: Keep data accurate and up to date
5. **Integrity & Confidentiality**: Protect against unauthorized access
6. **Accountability**: Demonstrate compliance

### Implementation Requirements

**User Consent**:
- Clear, specific consent for data collection
- Ability to withdraw consent
- Document consent with timestamp and version

**User Rights**:
- Right to access their data
- Right to correct inaccurate data
- Right to delete data (with retention requirements exceptions)
- Right to data portability
- Right to object to processing

**Data Breach Response**:
- Detection and logging of security incidents
- Incident response procedure
- Notification requirements (72 hours for GDPR)
- Documentation of breaches and response

### Implementation Checklist

- [ ] Privacy policy clear and accessible
- [ ] Consent mechanism implemented
- [ ] User can view their own data
- [ ] User can export their data
- [ ] User can request deletion (with compliant handling of retention requirements)
- [ ] Data processing agreements with third parties
- [ ] Breach detection and notification procedures
- [ ] Data protection impact assessment (DPIA) completed

## ðŸ”’ Observability Requirements (Debugging & Performance)

> **Purpose**: Enable debugging, monitoring, and performance evaluation through structured operational logging. This is separate from audit trails.

### Critical Distinction: Two Separate Logging Systems

This system implements **TWO separate and distinct logging systems** that must never be confused:

1. **Audit Trail** (Compliance & Data Integrity)
2. **Operational Logging** (Debugging & Performance)

**CRITICAL**: These systems serve different purposes, have different retention policies, and contain different types of information. Never log operational debugging information in the audit trail, and never log PII/PHI in operational logs.

---

### Audit Trail (Compliance)

#### Purpose
- **Regulatory compliance** (FDA 21 CFR Part 11, HIPAA)
- **Data integrity verification** and forensic investigation
- **Legal evidence** for regulatory inspections
- **Complete change history** for all clinical data

#### Implementation
- **Storage**: PostgreSQL `record_audit` table (event store)
- **Retention**: **Permanent** (minimum 7 years for FDA compliance)
- **Immutability**: Enforced by database rules (no updates/deletes)
- **Format**: Structured database records with cryptographic hashes

#### What to Log (âœ…)
âœ… All data create/update/delete operations
âœ… User identification and role
âœ… Timestamps (both client and server)
âœ… Change reason (required field)
âœ… Device and IP information
âœ… Session identifiers
âœ… Cryptographic signatures (tamper detection)
âœ… Parent audit references (change chains)

#### What NOT to Log (âŒ)
âŒ System debugging information
âŒ Performance metrics
âŒ Transient application errors
âŒ Cache operations
âŒ API request/response details
âŒ Stack traces

#### Data Structure
```sql
record_audit (event store):
- audit_id (sequence number)
- event_uuid (event identifier)
- patient_id (de-identified)
- site_id (clinical site)
- operation (USER_CREATE, USER_UPDATE, etc.)
- data (JSONB - the actual change)
- created_by (user ID)
- role (USER, INVESTIGATOR, ANALYST, ADMIN)
- client_timestamp, server_timestamp
- change_reason (required - why was this changed)
- device_info, ip_address, session_id
- signature_hash (SHA-256 tamper detection)
- parent_audit_id (change chain)
```

#### Access Pattern
```sql
-- Query audit history for an event
SELECT * FROM record_audit
WHERE event_uuid = '...'
ORDER BY audit_id;

-- Verify audit chain integrity
SELECT * FROM validate_audit_chain('event-uuid');

-- Check ALCOA+ compliance
SELECT * FROM validate_alcoa_compliance(audit_id);
```

---

### Operational Logging (Debugging)

#### Purpose
- **Troubleshooting** and debugging application issues
- **Performance monitoring** and optimization
- **System health monitoring** and alerting
- **Error tracking** and resolution
- **Usage analytics** (non-compliance)

#### Implementation
- **Storage**: Application-layer logging service (NOT database)
  - Options: CloudWatch, Datadog, Elastic Stack, Grafana Loki
- **Retention**: 30-90 days (configurable based on needs)
- **Format**: Structured JSON with correlation IDs
- **Levels**: DEBUG, INFO, WARN, ERROR, FATAL

#### What to Log (âœ…)
âœ… System startup/shutdown events
âœ… API request/response times
âœ… Database query performance
âœ… Error stack traces
âœ… Cache hits/misses
âœ… External service calls
âœ… Authentication attempts (success/failure)
âœ… Rate limit hits
âœ… Background job execution
âœ… Configuration changes

#### What NOT to Log (âŒ)
âŒ **Passwords** or credentials
âŒ **PII** (names, emails, addresses in plain text)
âŒ **PHI** (health information, clinical data)
âŒ **Complete audit trail data** (use audit table instead)
âŒ **API keys** or tokens
âŒ **Session tokens** or JWTs
âŒ **Encryption keys**
âŒ **Credit card numbers** or financial data

#### Log Levels

**DEBUG** (Development only):
- Detailed diagnostic information
- Variable values, execution paths
- Never enabled in production

**INFO** (Normal operations):
- System startup/shutdown
- User login (user ID only, not credentials)
- Successful operations
- Background jobs completed

**WARN** (Unexpected but handled):
- Deprecated API usage
- Approaching rate limits
- Retry attempts
- Configuration issues

**ERROR** (Operation failures):
- Failed API requests
- Database connection issues
- Invalid user input
- External service failures

**FATAL** (System failures):
- Database unavailable
- Critical service dependencies down
- Out of memory errors
- Unrecoverable errors

#### Structured Format

```json
{
  "timestamp": "2025-10-15T14:23:45.123Z",
  "level": "INFO",
  "component": "api.diary",
  "correlation_id": "req_7f3d9a8b",
  "user_id": "user_123",
  "user_role": "INVESTIGATOR",
  "message": "Diary entry created successfully",
  "operation": "create_diary_entry",
  "duration_ms": 45,
  "context": {
    "site_id": "site_001",
    "event_type": "USER_CREATE",
    "conflicts_detected": 0
  }
}
```

#### Correlation IDs

Use correlation IDs to track requests across services:

```javascript
// Generate correlation ID per request
const correlationId = `req_${uuidv4()}`;

// Include in all logs for this request
logger.info({
  correlation_id: correlationId,
  message: "Processing diary entry",
  // ...
});

// Pass to audit trail in metadata
await insertAudit({
  // ... audit fields
  metadata: { correlation_id: correlationId }
});
```

This allows linking operational logs to audit trail entries for investigation.

---

### Separation of Concerns

| Aspect | Audit Trail | Operational Logs |
|--------|-------------|------------------|
| **Purpose** | Compliance, legal evidence | Debugging, monitoring |
| **Storage** | PostgreSQL database | Log aggregation service |
| **Retention** | 7+ years (permanent) | 30-90 days |
| **Immutable** | Yes (enforced by DB) | No (rotated out) |
| **Contains PII/PHI** | Yes (de-identified) | **NO** (never) |
| **Query Method** | SQL | Log search tool |
| **Audience** | Regulators, auditors, compliance | Developers, operations |
| **Format** | Database records | Structured JSON |
| **Compliance** | FDA, HIPAA, GDPR | Internal use only |
| **Encryption** | Database encryption | Transport encryption only |

---

### Examples

#### âœ… CORRECT: Audit Trail Usage

```sql
-- Recording a patient diary entry
INSERT INTO record_audit (
    event_uuid,
    patient_id,
    site_id,
    operation,
    data,
    created_by,
    role,
    client_timestamp,
    change_reason,
    device_info,
    ip_address,
    session_id
) VALUES (
    gen_random_uuid(),
    'patient_001',
    'site_001',
    'USER_CREATE',
    '{"symptoms": ["headache", "nausea"], "severity": 7}'::jsonb,
    'user_123',
    'USER',
    now(),
    'Daily symptom log entry',
    '{"device": "iPhone", "os": "iOS 17", "app_version": "1.2.3"}'::jsonb,
    '192.168.1.100'::inet,
    'sess_abc123'
);
```

#### âœ… CORRECT: Operational Logging

```javascript
// Logging API request
logger.info({
  correlation_id: "req_abc123",
  component: "api.diary",
  user_id: "user_123",  // ID only, not PII
  user_role: "USER",
  operation: "create_entry",
  duration_ms: 45,
  status: "success",
  message: "Diary entry created"
});

// Logging error
logger.error({
  correlation_id: "req_abc123",
  component: "api.sync",
  user_id: "user_123",
  operation: "sync_offline_data",
  error_type: "ConflictDetected",
  error_message: "Multiple devices modified same entry",
  stack: error.stack,
  message: "Conflict resolution required"
});
```

#### âŒ INCORRECT: Don't Mix These Up

```javascript
// âŒ WRONG: Operational debug in audit trail
INSERT INTO record_audit (..., change_reason)
VALUES (..., 'API request took 450ms, retried twice');
// This is operational info, not a compliance reason

// âŒ WRONG: PII in operational logs
logger.info({
  message: "User logged in",
  email: "john.doe@example.com",  // âŒ PII
  full_name: "John Doe",           // âŒ PII
  patient_symptoms: ["headache"]   // âŒ PHI
});
// Use user_id instead, not email or name

// âŒ WRONG: Complete data payloads in logs
logger.debug({
  message: "Received data",
  payload: req.body  // âŒ May contain PHI/PII
});
// Log metadata only, not actual data
```

---

### Application Layer Responsibilities

#### Backend API

1. **Audit Trail**:
   - Capture all data modifications
   - Populate all required fields
   - Never allow bypass of audit trail
   - Validate change_reason is meaningful

2. **Operational Logging**:
   - Generate correlation IDs
   - Log request/response times
   - Never log PII/PHI
   - Use structured logging

#### Mobile App

1. **Audit Trail**:
   - Generate event_uuid client-side
   - Capture client_timestamp accurately
   - Include device_info
   - Queue audit entries for offline sync

2. **Operational Logging**:
   - Log app crashes and errors
   - Track sync performance
   - Never log patient data locally
   - Send anonymized analytics only

---

### Compliance Implications

#### FDA 21 CFR Part 11

**Audit Trail Requirements**:
- âœ… 11.10(e): Generate audit trails
- âœ… 11.10(e)(1): Date/time stamps
- âœ… 11.10(e)(2): Operator identification
- âœ… 11.10(e)(3): Action taken

**Operational Logs**: Not subject to Part 11 (not compliance records)

#### HIPAA

**Audit Trail**:
- De-identified data (not PHI)
- Encrypted at rest and in transit
- Access controls enforced
- 7+ year retention

**Operational Logs**:
- **MUST NOT contain PHI**
- Can be deleted after 90 days
- Used for security monitoring only

#### GDPR

**Audit Trail**:
- De-identified data (not personal data)
- Retention justified by compliance needs
- Access restricted

**Operational Logs**:
- Minimize personal data
- Short retention (30-90 days)
- Include in privacy impact assessment

---

### Monitoring & Alerting

#### Audit Trail Monitoring

```sql
-- Daily compliance check
SELECT * FROM generate_compliance_report(
    now() - interval '1 day',
    now()
);

-- Alert if missing metadata
SELECT COUNT(*) FROM record_audit
WHERE created_at > now() - interval '1 hour'
AND (change_reason IS NULL OR signature_hash IS NULL);
-- Alert if > 0
```

#### Operational Log Monitoring

```javascript
// Alert on error rate
if (errorRate > 1% over 5min) {
  alert('High error rate detected');
}

// Alert on slow API responses
if (p95ResponseTime > 1000ms) {
  alert('Slow API performance');
}

// Alert on failed authentication
if (failedLogins > 5 for same IP) {
  alert('Possible brute force attack');
}
```

---

### Testing

#### Audit Trail Tests

```sql
-- Test: Audit entries are immutable
BEGIN;
INSERT INTO record_audit (...) VALUES (...);
UPDATE record_audit SET data = '{}' WHERE audit_id = 1;
-- Should fail (rule prevents updates)
ROLLBACK;

-- Test: Required fields enforced
INSERT INTO record_audit (...) VALUES (...); -- Missing change_reason
-- Should fail with constraint violation
```

#### Operational Logging Tests

```javascript
// Test: PII not logged
const result = captureLog(() => {
  logger.info({ user_id: "123", name: "John" });
});
assert(!result.includes("John"));

// Test: Correlation IDs propagate
const correlationId = generateCorrelationId();
await processRequest(correlationId);
const logs = await queryLogs({ correlation_id: correlationId });
assert(logs.length > 0);
```

---

### Team Training

#### For Developers

1. **Always ask**: Is this compliance data or operational data?
2. **Audit trail**: Use for all data changes only
3. **Operational logs**: Use for everything else
4. **Never**: Log passwords, PHI, or complete data payloads
5. **Always**: Use correlation IDs to link logs

#### For Operations

1. **Audit trail**: Query via SQL, retain permanently
2. **Operational logs**: Use log aggregation tools, rotate after 90 days
3. **Monitoring**: Set up alerts for both systems
4. **Incidents**: Use correlation IDs to trace requests

#### For Compliance

1. **Audit trail**: This is your compliance record
2. **Operational logs**: Not for regulatory inspection
3. **Reports**: Generate from audit trail only
4. **Validation**: Verify audit trail completeness regularly

---

### Quick Reference

| What are you logging? | Use This |
|----------------------|----------|
| User created/updated/deleted data | **Audit Trail** |
| API request took 200ms | **Operational Log** |
| Authentication succeeded | **Both** (different details) |
| Database query was slow | **Operational Log** |
| Change reason: "Correcting typo" | **Audit Trail** |
| Stack trace from exception | **Operational Log** |
| Cryptographic hash verification | **Audit Trail** |
| Cache miss | **Operational Log** |
| Regulatory inspector request | **Audit Trail** |
| Developer debugging | **Operational Log** |

---

### Observability Checklist

- [ ] All components implement structured logging (JSON format)
- [ ] Correlation IDs flow through entire request chain
- [ ] Performance metrics captured for critical operations
- [ ] Error logs include full context and stack traces
- [ ] No sensitive data (PII/PHI) in operational logs
- [ ] Log aggregation system configured (e.g., ELK, Splunk, Datadog)
- [ ] Alerts configured for ERROR and FATAL levels
- [ ] Dashboard for real-time system health monitoring
- [ ] Clear separation between audit trails and operational logs maintained
- [ ] Audit trail immutability enforced by database rules
- [ ] Audit trail retention meets regulatory requirements (7+ years)
- [ ] Operational log retention configured (30-90 days)

---

**Remember**: Compliance is not a one-time activity but an ongoing commitment. The distinction between audit trails (compliance) and operational logs (debugging) is critical for regulatory compliance. When in doubt, document your decision-making process and consult with compliance experts.

---

## Continuous Compliance

### Regular Activities

**Weekly**:
- Review audit trails for data integrity anomalies
- Monitor operational logs for system errors and warnings
- Check for dependency vulnerabilities
- Analyze performance metrics from logs

**Monthly**:
- Review access controls
- Audit user accounts and permissions
- Review compliance test results

**Quarterly**:
- Update risk assessment
- Review and test disaster recovery
- Training on compliance requirements
- Review and update documentation

**Annually**:
- Full compliance audit
- Penetration testing
- Review and update SOPs
- Regulatory update review
- Validation maintenance

### When to Involve Compliance Experts

Involve quality assurance and regulatory specialists for:

- Initial system design
- Major architectural changes
- New compliance requirements
- Audit findings
- Regulatory submissions
- Interpretation of regulations
- Risk assessments

### Reference Material

https://www.fda.gov/drugs/cder-small-business-industry-assistance-sbia/regulatory-education-industry-redi-fda-mhra-good-clinical-practice-workshop-data-integrity-global

---

**Source Files**:
- Original dev-compliance-practices.md
- dev-continuous-compliance.md (merged 2025-10-17)
